{"version":3,"file":"js/5217.js","mappings":"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","sources":["webpack:///./resources/js/Pages/Shop/Checkout.vue","webpack:///./resources/js/Pages/Shop/Checkout.vue?4214"],"sourcesContent":["<template>\n\n    <Head title=\"Checkout\" />\n\n    <div class=\"place-self-center flex flex-col gap-y-3\">\n        <div id=\"topDiv\" class=\"bg-white text-black dark:bg-gray-800 dark:text-gray-50 p-5 mb-10\">\n\n            <Message v-if=\"userStore.showFlashMessage\" :flash=\"$page.props.flash\"/>\n\n            <header class=\"flex justify-between mb-3\">\n                <div id=\"topDiv\">\n                    <h1 class=\"text-3xl font-semibold pb-3\">Checkout <span class=\"inline-block ml-1\" v-text=\"'(' + shopStore.cart.length + ' items)'\"></span></h1>\n                </div>\n            </header>\n\n            <div>\n                <Link :href=\"route('products')\"><button\n                    class=\"bg-blue-600 hover:bg-blue-400 text-white px-2 py-1 rounded\">\n                    See all products\n                </button>\n                </Link>\n            </div>\n\n            <div class=\"mb-4 w-full\">\n                <div class=\"lg:w-2/3 w-full mx-auto mt-8 overflow-auto\">\n                    <table class=\"table-auto w-full text-left whitespace-no-wrap\">\n                        <thead>\n                        <tr>\n                            <th class=\"px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-200 rounded-tl rounded-bl\">Item</th>\n                            <th class=\"px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-200\">Quantity</th>\n                            <th class=\"px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-200\">Price</th>\n                            <th class=\"px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-200\">Actions</th>\n                        </tr>\n                        </thead>\n                        <tbody>\n                            <tr v-for=\"(item, index) in shopStore.cart\" :key=\"item.id\">\n                                <td class=\"p-4\" v-text=\"item.name\"></td>\n                                <td class=\"p-4\" v-text=\"item.quantity\"></td>\n                                <td class=\"p-4\" v-text=\"shopStore.cartLineTotal(item)\"></td>\n                                <td class=\"w-10 text-right\">\n                                    <button\n                                        class=\"flex ml-auto text-sm text-white bg-blue-600 border-0 py-2 px-6 focus:outline-none hover:bg-blue-700 rounded\"\n                                        @click.prevent=\"shopStore.removeFromCart(index)\">\n                                        Remove</button>\n                                </td>\n                            </tr>\n                            <tr>\n                                <td class=\"p-4 font-bold\">Total Amount</td>\n                                <td class=\"p-4 font-bold\" v-text=\"shopStore.cartQuantity\"></td>\n                                <td class=\"p-4 font-bold\" v-text=\"shopStore.cartTotal\"></td>\n                                <td class=\"w-10 text-right\"></td>\n                            </tr>\n                        </tbody>\n                    </table>\n                </div>\n                <div class=\"lg:w-2/3 w-full mx-auto mt-8\">\n                    <h2 class=\"px-2 text-2xl font-semibold text-black dark:text-gray-100\">Billing Info</h2>\n                    <div class=\"flex flex-wrap -mx-2\">\n                        <div class=\"p-2 w-2/3\">\n                            <div class=\"relative\">\n                                <label for=\"name\" class=\"leading-7 text-sm text-black dark:text-gray-200\">Name</label>\n                                <input\n                                    type=\"text\"\n                                    id=\"name\"\n                                    name=\"name\"\n                                    v-model=\"shopStore.customer.name\"\n                                    class=\"w-full bg-gray-100 rounded border border-gray-300 focus:border-indigo-500 text-gray-700 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out\"\n                                    :disabled=\"paymentProcessing\"\n                                >\n                            </div>\n                        </div>\n                        <div class=\"p-2\">\n                            <div class=\"relative\">\n                                <label for=\"address1\" class=\"leading-7 text-sm text-black dark:text-gray-200\">Address Line 1</label>\n                                <input\n                                    type=\"text\"\n                                    id=\"address1\"\n                                    name=\"address1\"\n                                    v-model=\"shopStore.customer.address1\"\n                                    class=\"w-full bg-gray-100 rounded border border-gray-300 focus:border-indigo-500 text-gray-700 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out\"\n                                    :disabled=\"paymentProcessing\"\n                                >\n                            </div>\n                        </div>\n                        <div class=\"p-2\">\n                            <div class=\"relative\">\n                                <label for=\"address2\" class=\"leading-7 text-sm text-black dark:text-gray-200\">Address Line 2</label>\n                                <input\n                                    type=\"text\"\n                                    id=\"address2\"\n                                    name=\"address2\"\n                                    v-model=\"shopStore.customer.address2\"\n                                    class=\"w-full bg-gray-100 rounded border border-gray-300 focus:border-indigo-500 text-gray-700 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out\"\n                                    :disabled=\"paymentProcessing\"\n                                >\n                            </div>\n                        </div>\n                        <div class=\"p-2\">\n                            <div class=\"relative\">\n                                <label for=\"city\" class=\"leading-7 text-sm text-black dark:text-gray-200\">City</label>\n                                <input\n                                    type=\"text\"\n                                    id=\"city\"\n                                    name=\"city\"\n                                    v-model=\"shopStore.customer.city\"\n                                    class=\"w-full bg-gray-100 rounded border border-gray-300 focus:border-indigo-500 text-gray-700 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out\"\n                                    :disabled=\"paymentProcessing\"\n                                >\n                            </div>\n                        </div>\n                        <div class=\"p-2\">\n                            <div class=\"relative\">\n                                <label for=\"province\" class=\"leading-7 text-sm text-black dark:text-gray-200\">Province</label>\n                                <region-select\n                                    id=\"province\"\n                                    name=\"province\"\n                                    v-model=\"shopStore.customer.province\"\n                                    :country=\"shopStore.customer.country\"\n                                    :region=\"shopStore.customer.province\"\n                                    class=\"w-full bg-gray-100 rounded border border-gray-300 focus:border-indigo-500 text-gray-700 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out\"\n                                    :disabled=\"paymentProcessing\"\n                                />\n                            </div>\n                        </div>\n                        <div class=\"p-2\">\n                            <div class=\"relative\">\n                                <label for=\"country\" class=\"leading-7 text-sm text-black dark:text-gray-200\">Country</label>\n                                <country-select\n                                    id=\"country\"\n                                    name=\"country\"\n                                    v-model=\"shopStore.customer.country\"\n                                    :country=\"shopStore.customer.country\"\n                                    topCountry=\"CA\"\n                                    class=\"w-full bg-gray-100 rounded border border-gray-300 focus:border-indigo-500 text-gray-700 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out\"\n                                    :disabled=\"paymentProcessing\"\n                                />\n                            </div>\n                        </div>\n                        <div class=\"p-2\">\n                            <div class=\"relative\">\n                                <label for=\"postalCode\" class=\"leading-7 text-sm text-black dark:text-gray-200\">Postal Code</label>\n                                <input\n                                    id=\"postalCode\"\n                                    name=\"postalCode\"\n                                    v-model=\"shopStore.customer.postalCode\"\n                                    class=\"w-full bg-gray-100 rounded border border-gray-300 focus:border-indigo-500 text-gray-700 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out\"\n                                    :disabled=\"paymentProcessing\"\n                                >\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"flex flex-wrap -ms-2 mt-4\">\n                        <div class=\"p-2 w-full\">\n                            <div class=\"relative\">\n                                <label for=\"card_element\" class=\"leading-7 text-sm text-black dark:text-gray-200\">Credit Card Information</label>\n                                <div id=\"card-element\"></div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"p-2 mb-24 w-full\">\n                        <button\n                            class=\"flex mx-auto text-white bg-blue-600 border-0 py-2 px-8 focus:outline-none hover:bg-blue-700 rounded\"\n                            @click.prevent=\"processPayment\"\n                            :disabled=\"paymentProcessing\"\n                            v-text=\"paymentProcessing ? 'Processing' : 'Pay Now'\"\n                        ></button>\n                    </div>\n                </div>\n            </div>\n\n            <!--            <div class=\"flex flex-row justify-end gap-x-4 mb-4\">-->\n\n            <!--                <input v-model=\"search\" type=\"search\" placeholder=\"Search...\" class=\"border px-2 rounded-lg\" />-->\n            <!--            </div>-->\n\n            <div class=\"px-2\">\n                <!--                Display items, services and events here.-->\n            </div>\n\n        </div>\n    </div>\n\n</template>\n\n<script setup>\nimport { onBeforeMount, onMounted, ref } from \"vue\"\nimport { useForm } from \"@inertiajs/inertia-vue3\"\nimport { useVideoPlayerStore } from \"@/Stores/VideoPlayerStore.js\"\nimport { useUserStore } from \"@/Stores/UserStore\"\nimport { useShopStore } from \"@/Stores/ShopStore\"\nimport Message from \"@/Components/Modals/Messages\"\nimport {loadStripe} from \"@stripe/stripe-js\";\n// import CountrySelect from \"@/Components/Forms/CountrySelect.vue\";\n// import RegionSelect from \"@/Components/Forms/RegionSelect.vue\";\n\nlet videoPlayerStore = useVideoPlayerStore()\nlet userStore = useUserStore()\nlet shopStore = useShopStore()\n\nuserStore.currentPage = 'checkout'\nuserStore.showFlashMessage = true;\n\nlet props = defineProps({\n    user: Object,\n    can: Object,\n\n})\n\nonMounted(async () => {\n    videoPlayerStore.makeVideoTopRight();\n    if (userStore.isMobile) {\n        videoPlayerStore.ottClass = 'ottClose'\n        videoPlayerStore.ott = 0\n    }\n    document.getElementById(\"topDiv\").scrollIntoView()\n\n    shopStore.getProducts()\n    shopStore.customer = props.user\n});\n\nlet form = useForm({\n    name: props.user.name,\n    address1: props.user.address1,\n    address2: props.user.address2,\n    city: props.user.city,\n    province: props.user.province,\n    country: props.user.country,\n    postalCode: props.user.postalCode,\n});\n\n\n\n</script>\n\n<script>\nimport { loadStripe } from '@stripe/stripe-js';\nimport { useShopStore } from '@/Stores/ShopStore'\nimport { Inertia } from \"@inertiajs/inertia\";\nexport default {\n    setup() {\n        // const shopStore = useShopStore()\n\n    },\n    props: {\n        user: Object,\n    },\n    data() {\n        const shopStore = useShopStore()\n        shopStore.customer = this.user\n        return {\n            stripe: {},\n            cardElement: {},\n            customer: shopStore.customer,\n            cart: shopStore.cart,\n            order: [],\n            paymentProcessing: false,\n            country: shopStore.customer.country,\n            region: shopStore.customer.province\n        }\n    },\n    async mounted() {\n        this.stripe = await loadStripe(process.env.MIX_STRIPE_KEY);\n\n        const elements = this.stripe.elements();\n        this.cardElement = elements.create('card', {\n            classes: {\n                base: 'bg-gray-100 py-3 px-2 rounded border border-gray-300 focus:border-indigo-500 text-gray-700 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out'\n            }\n        });\n\n        this.cardElement.mount('#card-element');\n    },\n    methods: {\n        updateOrder(order) {\n            this.order = order;\n        },\n        updateCart(cart) {\n            this.cart = cart;\n        },\n        clearCart() {\n            this.updateCart = [];\n        },\n        async processPayment() {\n            // send the payment information to Laravel + Stripe\n            this.paymentProcessing = true;\n\n            const {paymentMethod, error} = await this.stripe.createPaymentMethod({\n                    type: 'card',\n                    card: this.cardElement,\n                    billing_details: {\n                        name: this.customer.name,\n                        email: this.customer.email,\n                        phone: this.customer.phone,\n                        address: {\n                            line1: this.customer.address1,\n                            line2: this.customer.address2,\n                            city: this.customer.city,\n                            state: this.customer.province,\n                            postal_code: this.customer.postalCode,\n                            country: this.customer.country,\n                        }\n                    }\n                }\n            );\n\n            if (error) {\n                this.paymentProcessing = false;\n                alert(error);\n            } else {\n                this.customer.payment_method_id = paymentMethod.id;\n                this.customer.amount = this.cart.reduce((acc, item) => acc + (item.price * item.quantity), 0);\n                this.customer.cart = JSON.stringify(this.cart);\n                console.log('you arrived here.');\n\n                axios.post('/shop/purchase', this.customer)\n                    .then((response) => {\n                        this.paymentProcessing = false;\n\n                        // this.updateOrder(response.data);\n                        this.order = this.cart;\n                        this.cart = [];\n                        console.log('you arrived at the second here.');\n                        Inertia.post('/shop/summary', {\n                                order: response.data\n                        })\n                    })\n                    .catch((error) => {\n                        this.paymentProcessing = false;\n                        alert(error);\n                    });\n            }\n        }\n    },\n    computed: {\n        // ...mapState(useShopStore, ['cart']),\n        // ...mapState(useShopStore, ['paymentProcessing']),\n        // ...mapState(useShopStore, ['order']),\n    },\n}\n\n</script>\n\n","import script from \"./Checkout.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Checkout.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["__default__","setup","props","user","Object","data","shopStore","useShopStore","customer","this","stripe","cardElement","cart","order","paymentProcessing","country","region","province","mounted","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","elements","wrap","_context","prev","next","loadStripe","process","sent","create","classes","base","mount","stop","methods","updateOrder","updateCart","clearCart","processPayment","_this2","_callee2","_yield$_this2$stripe$","paymentMethod","error","_context2","createPaymentMethod","type","card","billing_details","name","email","phone","address","line1","address1","line2","address2","city","state","postal_code","postalCode","alert","payment_method_id","id","amount","reduce","acc","item","price","quantity","JSON","stringify","console","log","axios","post","then","response","Inertia","computed","videoPlayerStore","useVideoPlayerStore","userStore","useUserStore","currentPage","showFlashMessage","__props","onMounted","_callee3","_context3","makeVideoTopRight","isMobile","ottClass","ott","document","getElementById","scrollIntoView","getProducts","useForm"],"sourceRoot":""}