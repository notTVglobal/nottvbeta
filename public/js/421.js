/*! For license information please see 421.js.LICENSE.txt */
"use strict";(self.webpackChunknottvbeta=self.webpackChunknottvbeta||[]).push([[421],{2435:(e,t,n)=>{n.d(t,{c:()=>c});var r=n(29726),o=n(20715),i=n(20973),a=n(58088),s=n(92995);function c(e){var t=(0,o.useUserStore)(),n=(0,i.useAppSettingStore)(),c=(0,a.useVideoPlayerStore)();n.currentPage=e,n.showFlashMessage=!0,n.pageIsHidden=!1,t.isMobile||window.innerWidth<1024||n.fullPage?n.ott=0:(0===n.ott&&(n.ott=4),n.showOttButtons=!0),c.makeVideoTopRight(),n.pageReload&&(n.pageReload=!1,n.pageWasReloaded=!0,window.location.reload()),s.QB.on("navigate",(function(e){t.isMobile||window.innerWidth<1024||n.fullPage?n.ott=0:0===n.ott&&(n.ott=4),""!==window.location.search&&!n.shouldScrollToTop||requestAnimationFrame((function(){var e=document.getElementById("topDiv");e?e.scrollIntoView({behavior:"auto"}):window.scrollTo(0,0)})),n.shouldScrollToTop=!1})),n.setPrevUrl(),n.showOttButtons=!0,n.noLayout=!1,(0,r.watch)((function(){return n.isSmallScreen}),(function(e){n.ott=e?0:4}),{immediate:!0})}},1284:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(54991),o=n.n(r),i=n(76314),a=n.n(i)()(o());a.push([e.id,'[data-v-1192cd5a]{box-sizing:border-box}body[data-v-1192cd5a]{-webkit-font-smoothing:antialiased;align-content:center;display:flex;font-family:-apple-system,BlinkMacSystemFont,sans-serif;font-size:16px;height:100vh;justify-content:center;width:100vw}form[data-v-1192cd5a]{align-self:center;border-radius:7px;box-shadow:0 0 0 .5px #32325d1a,0 2px 5px 0 #32325d1a,0 1px 1.5px 0 #00000012;min-width:500px;padding:40px;width:30vw}.hidden[data-v-1192cd5a]{display:none}#payment-message[data-v-1192cd5a]{color:#697386;font-size:16px;line-height:20px;padding-top:12px;text-align:center}#payment-element[data-v-1192cd5a]{margin-bottom:24px}button[data-v-1192cd5a]{background:#5469d4;border:0;border-radius:4px;box-shadow:0 4px 5.5px 0 #00000012;color:#fff;cursor:pointer;display:block;font-family:Arial,sans-serif;font-size:16px;font-weight:600;padding:12px 16px;transition:all .2s ease;width:100%}button[data-v-1192cd5a]:hover{filter:contrast(115%)}button[data-v-1192cd5a]:disabled{cursor:default;opacity:.5}.spinner[data-v-1192cd5a],.spinner[data-v-1192cd5a]:after,.spinner[data-v-1192cd5a]:before{border-radius:50%}.spinner[data-v-1192cd5a]{box-shadow:inset 0 0 0 2px;color:#fff;font-size:22px;height:20px;margin:0 auto;position:relative;text-indent:-99999px;transform:translateZ(0);width:20px}.spinner[data-v-1192cd5a]:after,.spinner[data-v-1192cd5a]:before{content:"";position:absolute}.spinner[data-v-1192cd5a]:before{animation:loading-1192cd5a 2s ease 1.5s infinite;border-radius:20.4px 0 0 20.4px;height:20.4px;left:-.2px;top:-.2px;transform-origin:10.4px 10.2px}.spinner[data-v-1192cd5a]:after,.spinner[data-v-1192cd5a]:before{background:#5469d4;width:10.4px}.spinner[data-v-1192cd5a]:after{animation:loading-1192cd5a 2s ease infinite;border-radius:0 10.2px 10.2px 0;height:10.2px;left:10.2px;top:-.1px;transform-origin:0 10.2px}@keyframes loading-1192cd5a{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@media only screen and (max-width:600px){form[data-v-1192cd5a]{min-width:auto;width:80vw}}',"",{version:3,sources:["webpack://./resources/js/Pages/Shop/Subscription.vue"],names:[],mappings:"AA0VA,kBACE,qBACF,CAEA,sBAGE,kCAAmC,CAGnC,oBAAqB,CAFrB,YAAa,CAHb,uDAA0D,CAC1D,cAAe,CAKf,YAAa,CAFb,sBAAuB,CAGvB,WACF,CAEA,sBAGE,iBAAkB,CAGlB,iBAAkB,CAFlB,6EAC4E,CAH5E,eAAgB,CAKhB,YAAa,CANb,UAOF,CAEA,yBACE,YACF,CAEA,kCACE,aAAyB,CACzB,cAAe,CACf,gBAAiB,CACjB,gBAAiB,CACjB,iBACF,CAEA,kCACE,kBACF,CAGA,wBACE,kBAAmB,CAInB,QAAS,CADT,iBAAkB,CAQlB,kCAAiD,CATjD,UAAc,CAMd,cAAe,CACf,aAAc,CARd,4BAA8B,CAK9B,cAAe,CACf,eAAgB,CAFhB,iBAAkB,CAKlB,uBAAyB,CAEzB,UACF,CAEA,8BACE,qBACF,CAEA,iCAEE,cAAe,CADf,UAEF,CAGA,2FAGE,iBACF,CAEA,0BAQE,0BAA2B,CAP3B,UAAc,CACd,cAAe,CAKf,WAAY,CAHZ,aAAgB,CAChB,iBAAkB,CAFlB,oBAAqB,CAQrB,uBAAwB,CALxB,UAMF,CAEA,iEAGE,UAAW,CADX,iBAEF,CAEA,iCAUE,gDAAwC,CANxC,+BAAgC,CAFhC,aAAc,CAId,UAAY,CADZ,SAAW,CAGX,8BAGF,CAEA,iEAVE,kBAAmB,CAFnB,YAuBF,CAXA,gCAUE,2CAAmC,CANnC,+BAAgC,CAFhC,aAAc,CAId,WAAY,CADZ,SAAW,CAGX,yBAGF,CAaA,4BACE,GAEE,sBACF,CACA,GAEE,uBACF,CACF,CAEA,yCACE,sBAEE,cAAkB,CADlB,UAEF,CACF",sourcesContent:['<template>\n\n  <Head title="Upgrade Account"/>\n\n  <div class="w-full lace-self-center flex flex-col gap-y-3 bg-orange-400">\n    <div id="topDiv" class="w-full bg-gray-800 text-gray-50 dark:bg-gray-800 dark:text-gray-50 p-5 mb-10">\n\n      \x3c!--            <Message v-if="appSettingStore.showFlashMessage" :flash="$page.props.flash"/>--\x3e\n\n      <header class="flex justify-center pt-4 mt-2 mb-4">\n        <h1 class="text-3xl font-semibold pb-3">\n          <span v-if="shopStore.upgradeSelection === \'yearlyContribution\'">Yearly Contribution</span>\n          <span v-if="shopStore.upgradeSelection === \'monthlyContribution\'">Monthly Contribution</span>\n        </h1>\n      </header>\n\n\n      <section id="security-assurance">\n        <div style="text-align: center; margin-bottom: 20px;">\n          \x3c!-- Font Awesome Padlock Icon --\x3e\n          <font-awesome-icon icon="fa-lock" aria-hidden="true" style="font-size: 24px; color: #2c3e50;"/>\n        </div>\n        <div style="text-align: center; max-width: 600px; margin: auto;">\n          <h2>Your Security, Our Priority</h2>\n          <p>We take your security seriously. All transactions are encrypted and processed through secure payment\n            gateways. Your payment information is never stored on our servers, ensuring your data remains private and\n            protected.</p>\n        </div>\n      </section>\n\n\n      <div v-if="!shopStore.showPaymentForm" class="mx-auto mt-8 px-12">\n        <h2 class="mt-6 mx-auto text-xl font-semibold text-white dark:text-gray-100">Payment form is loading...</h2>\n      </div>\n\n      <div class="flex flex-col justify-center items-center w-full mx-auto mt-8">\n\n\n        <div v-if="shopStore.upgradeSelection===\'\'"\n             class="mt-6 mb-12 flex flex-col items-center justify-center text-center">\n          <div class="text-xl">Choose a subscription:</div>\n          <div class="mt-2 w-fit">\n            <button @click.prevent="shopStore.monthlyContribution()">\n              Monthly Contribution - ${{ shopStore.formattedMonthlySubscriptionPrice  }} / month</button>\n          </div>\n          <div class="mt-2 w-fit">\n            <button @click.prevent="shopStore.yearlyContribution()">\n              Yearly Contribution - ${{ shopStore.formattedYearlySubscriptionPrice }} / year</button>\n          </div>\n          <div class="mt-2 w-fit">\n            <button @click.prevent="router.visit(\'/contribute\')" class="">ðŸ‘ˆ Back to Contribute Page</button>\n          </div>\n        </div>\n        <h2 class="text-2xl font-semibold text-gray-100 dark:text-gray-100">Payment</h2>\n\n        <div class="flex flex-row justify-center w-full px-8">\n          <div v-if="shopStore.upgradeSelection!==\'\'" class="space-y-2 flex flex-col">\n            <div v-if="shopStore.upgradeSelection===\'monthlyContribution\'">\n              <label for="standard" class="font-semibold">Monthly Contribution - $25 / month</label>\n            </div>\n            <div v-if="shopStore.upgradeSelection===\'yearlyContribution\'">\n              <label for="standard" class="font-semibold">Yearly Contribution - $250 / year</label>\n            </div>\n          </div>\n          <div v-if="shopStore.upgradeSelection!==\'\'"\n               class="px-2 text-blue-500 hover:text-blue-400 font-semibold hover:underline hover:cursor-pointer"\n               @click="shopStore.changeUpgradeSelection()">(change)\n          </div>\n        </div>\n\n        <form id="payment-form" class="w-full">\n          <div id="link-authentication-element" class="mb-2">\n            \x3c!--Stripe.js injects the Link Authentication Element--\x3e\n          </div>\n          <div id="payment-element" class="w-full">\n            \x3c!--Stripe.js injects the Payment Element--\x3e\n          </div>\n          <div class="mb-2 text-xs text-gray-300">By clicking â€˜Complete Paymentâ€™, you agree to our Terms and Conditions\n            and acknowledge our Privacy Policy.\n          </div>\n          <button id="submit"\n                  class="h-fit bg-blue-600 hover:bg-blue-500 text-white rounded py-2 px-4"\n                  @click.prevent="submit()">\n            <div class="spinner hidden" id="spinner"></div>\n            <span id="button-text">Complete Payment</span>\n          </button>\n          <div id="payment-message" class="hidden"></div>\n        </form>\n\n        <div>Your payment is secured with SSL encryption.</div>\n\n        \x3c!-- {/* Show any error or success messages */}--\x3e\n        <div v-if="error" id="payment-error" class="text-red-600 font-semibold w-full my-2"> {{ error }}</div>\n\x3c!--        <div v-if="message" id="payment-message" class="mt-1 text-white">{{ message }}</div>--\x3e\n      </div>\n\n\n    </div>\n  </div>\n\n</template>\n\n<script setup>\nimport { onBeforeUnmount, onMounted, watch } from \'vue\'\nimport { usePageSetup } from \'@/Utilities/PageSetup\'\nimport { useUserStore } from \'@/Stores/UserStore\'\nimport { useAppSettingStore } from \'@/Stores/AppSettingStore\'\nimport { useNotificationStore } from \'@/Stores/NotificationStore\'\nimport { useShopStore } from \'@/Stores/ShopStore\'\nimport { useForm } from \'@inertiajs/vue3\'\nimport { router } from \'@inertiajs/vue3\'\n\nusePageSetup(\'shop/subscribe\')\n\nconst userStore = useUserStore()\nconst appSettingStore = useAppSettingStore()\nconst notificationStore = useNotificationStore()\nconst shopStore = useShopStore()\n\nlet props = defineProps({\n  user: Object,\n  error: String,\n  payment_method: Object, // not being used on this page yet.\n  intent: Object,\n  subscriptionSettings: Object,\n  // elements: {},\n})\n\nconst options = {\n  mode: \'setup\',\n  currency: \'cad\',\n}\n\nlet stripe\nlet elements\nlet emailAddress\n\nlet StripeAPIKey = \'\'\nStripeAPIKey = process.env.MIX_STRIPE_KEY\n\n// Watch for changes in userStore.hasConsentedToCookies\nwatch(\n    () => userStore.hasConsentedToCookies,\n    (newVal) => {\n      try {\n        appSettingStore.showCookieBanner = !newVal\n        showPaymentForm()\n      } catch (error) {\n        notificationStore.setToastNotification(\'Cookie error\', \'error\')\n        console.error("Error in watcher for hasConsentedToCookies:", error)\n      }\n    },\n    { immediate: true }, // Execute immediately on load\n)\n\nwatch(\n    () => userStore.hasConsentedToCookies,\n    async (newVal) => {\n      try {\n        appSettingStore.showCookieBanner = !newVal\n        if (newVal) {\n          // Dynamically import Stripe library only after consent is given\n          const { loadStripe } = await import(\'@stripe/stripe-js\')\n\n          if (!StripeAPIKey) {\n            notificationStore.setToastNotification(\'Stripe API key is missing\', \'error\')\n          }\n\n          stripe = await loadStripe(StripeAPIKey)\n\n          if (!stripe) {\n            notificationStore.setToastNotification(\'Failed to load Stripe\', \'error\')\n          }\n\n          initialize()\n          shopStore.showPaymentForm = true\n          document.querySelector(\'#payment-form\')\n        }\n      } catch (error) {\n        notificationStore.setToastNotification(\'Cookie error: \' + error, \'error\')\n        console.error("Error in watcher for hasConsentedToCookies:", error)\n      }\n    },\n    { immediate: false }, // Do not execute immediately on load\n)\n\nonMounted(async () => {\n      shopStore.loadSubscriptionSettings(props.subscriptionSettings)\n      if (!userStore.hasConsentedToCookies) {\n        appSettingStore.showCookieBanner = true\n      } else {\n        // Dynamically import Stripe library if user has already consented\n        const {loadStripe} = await import(\'@stripe/stripe-js\')\n        const stripePromise = loadStripe(process.env.MIX_STRIPE_KEY)\n        stripe = await stripePromise\n        initialize()\n        shopStore.showPaymentForm = true\n      }\n      shopStore.customer = props.user\n    },\n)\n\nonBeforeUnmount(() => {\n  shopStore.reset()\n})\n\n// onMounted(async () => {\n//   // shopStore.customer = props.user\n//\n//   // stripe = await loadStripe(StripeAPIKey)\n//\n//   // initialize()\n//\n//\n//\n//\n//   document\n//       .querySelector(\'#payment-form\')\n//   // .addEventListener("submit", handleSubmit);\n//\n//\n// })\n\nfunction showPaymentForm() {\n  shopStore.showPaymentForm = true\n}\n\nfunction initialize() {\n\n  const clientSecret = props.intent.client_secret\n  const appearance = {\n    theme: \'stripe\',\n    variables: {\n      colorPrimary: \'#0570de\',\n      colorBackground: \'#ffffff\',\n      colorBackgroundText: \'#ffffff\',\n      colorText: \'#222222\',\n      colorDanger: \'#df1b41\',\n      fontFamily: \'Ideal Sans, system-ui, sans-serif\',\n      spacingUnit: \'4px\',\n    },\n    rules: {\n      \'.Label\': {\n        color: \'var(--colorBackgroundText)\',\n      },\n    },\n  }\n\n  elements = stripe.elements({appearance, clientSecret})\n\n  // this is for linkPayments\n  // const linkAuthenticationElement = elements.create("linkAuthentication");\n  // linkAuthenticationElement.mount("#link-authentication-element");\n  //\n  // linkAuthenticationElement.on(\'change\', (event) => {\n  //     emailAddress = event.value.email;\n  // });\n\n  const paymentElementOptions = {\n    layout: \'tabs\',\n  }\n\n  const paymentElement = elements.create(\'payment\', paymentElementOptions)\n  paymentElement.mount(\'#payment-element\')\n\n}\n\nasync function submit() {\n  if (shopStore.upgradeStripeId === \'\' || null) {\n    alert(\'Please select a subscription.\')\n    return\n  }\n  setLoading(true)\n\n  const {setupIntent, error} = await stripe.confirmSetup({\n    elements,\n    confirmParams: {\n      // Make sure to change this to your payment completion page\n      return_url: \'http://localhost/contribute/subscription_success/stripe_return_url\',\n    },\n    redirect: \'if_required\',\n\n\n  })\n\n  // This point will only be reached if there is an immediate error when\n  // confirming the payment. Otherwise, your customer will be redirected to\n  // your `return_url`. For some payment methods like iDEAL, your customer will\n  // be redirected to an intermediate site first to authorize the payment, then\n  // redirected to the `return_url`.\n\n  if (error) {\n    if (error.type === \'card_error\' || error.type === \'validation_error\') {\n      notificationStore.setGeneralServiceNotification(error.code, error.message)\n      showMessage(error.message)\n      setLoading(false)\n    } else {\n      showMessage(\'An unexpected error occurred.\')\n      setLoading(false)\n    }\n  } else {\n    // console.log(setupIntent)\n    let form = useForm({\n      paymentMethod: setupIntent.payment_method,\n      plan: shopStore.upgradeStripeId,\n    })\n    //Submit the form\n    form.post(\'/contribute/subscription\')\n\n  }\n}\n\n\n// ------- UI helpers -------\n\nfunction showMessage(messageText) {\n  const messageContainer = document.querySelector(\'#payment-message\')\n\n  messageContainer.classList.remove(\'hidden\')\n  messageContainer.textContent = messageText\n\n  setTimeout(function () {\n    messageContainer.classList.add(\'hidden\')\n    messageContainer.textContent = \'\'\n  }, 4000)\n}\n\n// Show a spinner on payment submission\nfunction setLoading(isLoading) {\n  if (isLoading) {\n    // Disable the button and show a spinner\n    document.querySelector(\'#submit\').disabled = true\n    document.querySelector(\'#spinner\').classList.remove(\'hidden\')\n    document.querySelector(\'#button-text\').classList.add(\'hidden\')\n  } else {\n    document.querySelector(\'#submit\').disabled = false\n    document.querySelector(\'#spinner\').classList.add(\'hidden\')\n    document.querySelector(\'#button-text\').classList.remove(\'hidden\')\n  }\n}\n\n<\/script>\n\n<style scoped>\n\n/* Variables */\n* {\n  box-sizing: border-box;\n}\n\nbody {\n  font-family: -apple-system, BlinkMacSystemFont, sans-serif;\n  font-size: 16px;\n  -webkit-font-smoothing: antialiased;\n  display: flex;\n  justify-content: center;\n  align-content: center;\n  height: 100vh;\n  width: 100vw;\n}\n\nform {\n  width: 30vw;\n  min-width: 500px;\n  align-self: center;\n  box-shadow: 0px 0px 0px 0.5px rgba(50, 50, 93, 0.1),\n  0px 2px 5px 0px rgba(50, 50, 93, 0.1), 0px 1px 1.5px 0px rgba(0, 0, 0, 0.07);\n  border-radius: 7px;\n  padding: 40px;\n}\n\n.hidden {\n  display: none;\n}\n\n#payment-message {\n  color: rgb(105, 115, 134);\n  font-size: 16px;\n  line-height: 20px;\n  padding-top: 12px;\n  text-align: center;\n}\n\n#payment-element {\n  margin-bottom: 24px;\n}\n\n/* Buttons and links */\nbutton {\n  background: #5469d4;\n  font-family: Arial, sans-serif;\n  color: #ffffff;\n  border-radius: 4px;\n  border: 0;\n  padding: 12px 16px;\n  font-size: 16px;\n  font-weight: 600;\n  cursor: pointer;\n  display: block;\n  transition: all 0.2s ease;\n  box-shadow: 0px 4px 5.5px 0px rgba(0, 0, 0, 0.07);\n  width: 100%;\n}\n\nbutton:hover {\n  filter: contrast(115%);\n}\n\nbutton:disabled {\n  opacity: 0.5;\n  cursor: default;\n}\n\n/* spinner/processing state, errors */\n.spinner,\n.spinner:before,\n.spinner:after {\n  border-radius: 50%;\n}\n\n.spinner {\n  color: #ffffff;\n  font-size: 22px;\n  text-indent: -99999px;\n  margin: 0px auto;\n  position: relative;\n  width: 20px;\n  height: 20px;\n  box-shadow: inset 0 0 0 2px;\n  -webkit-transform: translateZ(0);\n  -ms-transform: translateZ(0);\n  transform: translateZ(0);\n}\n\n.spinner:before,\n.spinner:after {\n  position: absolute;\n  content: "";\n}\n\n.spinner:before {\n  width: 10.4px;\n  height: 20.4px;\n  background: #5469d4;\n  border-radius: 20.4px 0 0 20.4px;\n  top: -0.2px;\n  left: -0.2px;\n  -webkit-transform-origin: 10.4px 10.2px;\n  transform-origin: 10.4px 10.2px;\n  -webkit-animation: loading 2s infinite ease 1.5s;\n  animation: loading 2s infinite ease 1.5s;\n}\n\n.spinner:after {\n  width: 10.4px;\n  height: 10.2px;\n  background: #5469d4;\n  border-radius: 0 10.2px 10.2px 0;\n  top: -0.1px;\n  left: 10.2px;\n  -webkit-transform-origin: 0px 10.2px;\n  transform-origin: 0px 10.2px;\n  -webkit-animation: loading 2s infinite ease;\n  animation: loading 2s infinite ease;\n}\n\n@-webkit-keyframes loading {\n  0% {\n    -webkit-transform: rotate(0deg);\n    transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes loading {\n  0% {\n    -webkit-transform: rotate(0deg);\n    transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n@media only screen and (max-width: 600px) {\n  form {\n    width: 80vw;\n    min-width: initial;\n  }\n}\n\n</style>\n\n\n\n\n\n'],sourceRoot:""}]);const s=a},40421:(e,t,n)=>{n.r(t),n.d(t,{default:()=>X});var r=n(29726),o=n(2435),i=n(20715),a=n(20973),s=n(7447),c=n(30990),l=n(92995);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function d(){d=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function p(e,t,n,r){var i=t&&t.prototype instanceof x?t:x,a=Object.create(i.prototype),s=new V(r||[]);return o(a,"_invoke",{value:P(e,n,s)}),a}function m(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=p;var f="suspendedStart",h="suspendedYield",y="executing",g="completed",b={};function x(){}function v(){}function A(){}var C={};l(C,a,(function(){return this}));var w=Object.getPrototypeOf,S=w&&w(w(T([])));S&&S!==n&&r.call(S,a)&&(C=S);var k=A.prototype=x.prototype=Object.create(C);function E(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function B(e,t){function n(o,i,a,s){var c=m(e[o],e,i);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==u(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function P(t,n,r){var o=f;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=N(s,r);if(c){if(c===b)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===f)throw o=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=y;var l=m(t,n,r);if("normal"===l.type){if(o=r.done?g:h,l.arg===b)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=g,r.method="throw",r.arg=l.arg)}}}function N(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),b;var i=m(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,b;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,b):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,b)}function F(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function V(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(F,this),this.reset(!0)}function T(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(u(t)+" is not iterable")}return v.prototype=A,o(k,"constructor",{value:A,configurable:!0}),o(A,"constructor",{value:v,configurable:!0}),v.displayName=l(A,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,A):(e.__proto__=A,l(e,c,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},E(B.prototype),l(B.prototype,s,(function(){return this})),t.AsyncIterator=B,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new B(p(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},E(k),l(k,c,"Generator"),l(k,a,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=T,V.prototype={constructor:V,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return s.type="throw",s.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),b},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),b}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;L(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:T(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),b}},t}function p(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function m(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){p(i,r,o,a,s,"next",e)}function s(e){p(i,r,o,a,s,"throw",e)}a(void 0)}))}}var f=function(e){return(0,r.pushScopeId)("data-v-1192cd5a"),e=e(),(0,r.popScopeId)(),e},h={class:"w-full lace-self-center flex flex-col gap-y-3 bg-orange-400"},y={id:"topDiv",class:"w-full bg-gray-800 text-gray-50 dark:bg-gray-800 dark:text-gray-50 p-5 mb-10"},g={class:"flex justify-center pt-4 mt-2 mb-4"},b={class:"text-3xl font-semibold pb-3"},x={key:0},v={key:1},A={id:"security-assurance"},C={style:{"text-align":"center","margin-bottom":"20px"}},w=f((function(){return(0,r.createElementVNode)("div",{style:{"text-align":"center","max-width":"600px",margin:"auto"}},[(0,r.createElementVNode)("h2",null,"Your Security, Our Priority"),(0,r.createElementVNode)("p",null,"We take your security seriously. All transactions are encrypted and processed through secure payment gateways. Your payment information is never stored on our servers, ensuring your data remains private and protected.")],-1)})),S={key:0,class:"mx-auto mt-8 px-12"},k=[f((function(){return(0,r.createElementVNode)("h2",{class:"mt-6 mx-auto text-xl font-semibold text-white dark:text-gray-100"},"Payment form is loading...",-1)}))],E={class:"flex flex-col justify-center items-center w-full mx-auto mt-8"},B={key:0,class:"mt-6 mb-12 flex flex-col items-center justify-center text-center"},P=f((function(){return(0,r.createElementVNode)("div",{class:"text-xl"},"Choose a subscription:",-1)})),N={class:"mt-2 w-fit"},F={class:"mt-2 w-fit"},L={class:"mt-2 w-fit"},V=f((function(){return(0,r.createElementVNode)("h2",{class:"text-2xl font-semibold text-gray-100 dark:text-gray-100"},"Payment",-1)})),T={class:"flex flex-row justify-center w-full px-8"},_={key:0,class:"space-y-2 flex flex-col"},j={key:0},M=[f((function(){return(0,r.createElementVNode)("label",{for:"standard",class:"font-semibold"},"Monthly Contribution - $25 / month",-1)}))],I={key:1},O=[f((function(){return(0,r.createElementVNode)("label",{for:"standard",class:"font-semibold"},"Yearly Contribution - $250 / year",-1)}))],U={id:"payment-form",class:"w-full"},Y=f((function(){return(0,r.createElementVNode)("div",{id:"link-authentication-element",class:"mb-2"},null,-1)})),D=f((function(){return(0,r.createElementVNode)("div",{id:"payment-element",class:"w-full"},null,-1)})),q=f((function(){return(0,r.createElementVNode)("div",{class:"mb-2 text-xs text-gray-300"},"By clicking â€˜Complete Paymentâ€™, you agree to our Terms and Conditions and acknowledge our Privacy Policy. ",-1)})),G=[f((function(){return(0,r.createElementVNode)("div",{class:"spinner hidden",id:"spinner"},null,-1)})),f((function(){return(0,r.createElementVNode)("span",{id:"button-text"},"Complete Payment",-1)}))],K=f((function(){return(0,r.createElementVNode)("div",{id:"payment-message",class:"hidden"},null,-1)})),z=f((function(){return(0,r.createElementVNode)("div",null,"Your payment is secured with SSL encryption.",-1)})),H={key:1,id:"payment-error",class:"text-red-600 font-semibold w-full my-2"};const W={__name:"Subscription",props:{user:Object,error:String,payment_method:Object,intent:Object,subscriptionSettings:Object},setup:function(e){(0,o.c)("shop/subscribe");var t,u,p,f=(0,i.useUserStore)(),W=(0,a.useAppSettingStore)(),Z=(0,s.useNotificationStore)(),R=(0,c.useShopStore)(),$=e;function Q(){var e=$.intent.client_secret;(u=t.elements({appearance:{theme:"stripe",variables:{colorPrimary:"#0570de",colorBackground:"#ffffff",colorBackgroundText:"#ffffff",colorText:"#222222",colorDanger:"#df1b41",fontFamily:"Ideal Sans, system-ui, sans-serif",spacingUnit:"4px"},rules:{".Label":{color:"var(--colorBackgroundText)"}}},clientSecret:e})).create("payment",{layout:"tabs"}).mount("#payment-element")}function X(){return(X=m(d().mark((function e(){var n,r,o;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==R.upgradeStripeId){e.next=3;break}return alert("Please select a subscription."),e.abrupt("return");case 3:return ee(!0),e.next=6,t.confirmSetup({elements:u,confirmParams:{return_url:"http://localhost/contribute/subscription_success/stripe_return_url"},redirect:"if_required"});case 6:n=e.sent,r=n.setupIntent,(o=n.error)?"card_error"===o.type||"validation_error"===o.type?(Z.setGeneralServiceNotification(o.code,o.message),J(o.message),ee(!1)):(J("An unexpected error occurred."),ee(!1)):(0,l.mN)({paymentMethod:r.payment_method,plan:R.upgradeStripeId}).post("/contribute/subscription");case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e){var t=document.querySelector("#payment-message");t.classList.remove("hidden"),t.textContent=e,setTimeout((function(){t.classList.add("hidden"),t.textContent=""}),4e3)}function ee(e){e?(document.querySelector("#submit").disabled=!0,document.querySelector("#spinner").classList.remove("hidden"),document.querySelector("#button-text").classList.add("hidden")):(document.querySelector("#submit").disabled=!1,document.querySelector("#spinner").classList.add("hidden"),document.querySelector("#button-text").classList.remove("hidden"))}return p="pk_test_51KJwK5Kahp38LUVYOjg7h425exCr6UZmMm1M24d31ZaS0HTsgPWIZE9Hd2F0KnREVHuPm2VHesX3J5SQfFFg7fTC00DMNpq1Lj",(0,r.watch)((function(){return f.hasConsentedToCookies}),(function(e){try{W.showCookieBanner=!e,R.showPaymentForm=!0}catch(e){Z.setToastNotification("Cookie error","error"),console.error("Error in watcher for hasConsentedToCookies:",e)}}),{immediate:!0}),(0,r.watch)((function(){return f.hasConsentedToCookies}),function(){var e=m(d().mark((function e(r){var o,i;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,W.showCookieBanner=!r,!r){e.next=15;break}return e.next=5,n.e(3660).then(n.bind(n,37427));case 5:return o=e.sent,i=o.loadStripe,e.next=10,i(p);case 10:(t=e.sent)||Z.setToastNotification("Failed to load Stripe","error"),Q(),R.showPaymentForm=!0,document.querySelector("#payment-form");case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(0),Z.setToastNotification("Cookie error: "+e.t0,"error"),console.error("Error in watcher for hasConsentedToCookies:",e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t){return e.apply(this,arguments)}}(),{immediate:!1}),(0,r.onMounted)(m(d().mark((function e(){var r,o,i;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(R.loadSubscriptionSettings($.subscriptionSettings),f.hasConsentedToCookies){e.next=5;break}W.showCookieBanner=!0,e.next=15;break;case 5:return e.next=7,n.e(3660).then(n.bind(n,37427));case 7:return r=e.sent,o=r.loadStripe,i=o("pk_test_51KJwK5Kahp38LUVYOjg7h425exCr6UZmMm1M24d31ZaS0HTsgPWIZE9Hd2F0KnREVHuPm2VHesX3J5SQfFFg7fTC00DMNpq1Lj"),e.next=12,i;case 12:t=e.sent,Q(),R.showPaymentForm=!0;case 15:R.customer=$.user;case 16:case"end":return e.stop()}}),e)})))),(0,r.onBeforeUnmount)((function(){R.reset()})),function(t,n){var o=(0,r.resolveComponent)("Head"),i=(0,r.resolveComponent)("font-awesome-icon");return(0,r.openBlock)(),(0,r.createElementBlock)(r.Fragment,null,[(0,r.createVNode)(o,{title:"Upgrade Account"}),(0,r.createElementVNode)("div",h,[(0,r.createElementVNode)("div",y,[(0,r.createElementVNode)("header",g,[(0,r.createElementVNode)("h1",b,["yearlyContribution"===(0,r.unref)(R).upgradeSelection?((0,r.openBlock)(),(0,r.createElementBlock)("span",x,"Yearly Contribution")):(0,r.createCommentVNode)("",!0),"monthlyContribution"===(0,r.unref)(R).upgradeSelection?((0,r.openBlock)(),(0,r.createElementBlock)("span",v,"Monthly Contribution")):(0,r.createCommentVNode)("",!0)])]),(0,r.createElementVNode)("section",A,[(0,r.createElementVNode)("div",C,[(0,r.createVNode)(i,{icon:"fa-lock","aria-hidden":"true",style:{"font-size":"24px",color:"#2c3e50"}})]),w]),(0,r.unref)(R).showPaymentForm?(0,r.createCommentVNode)("",!0):((0,r.openBlock)(),(0,r.createElementBlock)("div",S,k)),(0,r.createElementVNode)("div",E,[""===(0,r.unref)(R).upgradeSelection?((0,r.openBlock)(),(0,r.createElementBlock)("div",B,[P,(0,r.createElementVNode)("div",N,[(0,r.createElementVNode)("button",{onClick:n[0]||(n[0]=(0,r.withModifiers)((function(e){return(0,r.unref)(R).monthlyContribution()}),["prevent"]))}," Monthly Contribution - $"+(0,r.toDisplayString)((0,r.unref)(R).formattedMonthlySubscriptionPrice)+" / month",1)]),(0,r.createElementVNode)("div",F,[(0,r.createElementVNode)("button",{onClick:n[1]||(n[1]=(0,r.withModifiers)((function(e){return(0,r.unref)(R).yearlyContribution()}),["prevent"]))}," Yearly Contribution - $"+(0,r.toDisplayString)((0,r.unref)(R).formattedYearlySubscriptionPrice)+" / year",1)]),(0,r.createElementVNode)("div",L,[(0,r.createElementVNode)("button",{onClick:n[2]||(n[2]=(0,r.withModifiers)((function(e){return(0,r.unref)(l.QB).visit("/contribute")}),["prevent"])),class:""},"ðŸ‘ˆ Back to Contribute Page")])])):(0,r.createCommentVNode)("",!0),V,(0,r.createElementVNode)("div",T,[""!==(0,r.unref)(R).upgradeSelection?((0,r.openBlock)(),(0,r.createElementBlock)("div",_,["monthlyContribution"===(0,r.unref)(R).upgradeSelection?((0,r.openBlock)(),(0,r.createElementBlock)("div",j,M)):(0,r.createCommentVNode)("",!0),"yearlyContribution"===(0,r.unref)(R).upgradeSelection?((0,r.openBlock)(),(0,r.createElementBlock)("div",I,O)):(0,r.createCommentVNode)("",!0)])):(0,r.createCommentVNode)("",!0),""!==(0,r.unref)(R).upgradeSelection?((0,r.openBlock)(),(0,r.createElementBlock)("div",{key:1,class:"px-2 text-blue-500 hover:text-blue-400 font-semibold hover:underline hover:cursor-pointer",onClick:n[3]||(n[3]=function(e){return(0,r.unref)(R).changeUpgradeSelection()})},"(change) ")):(0,r.createCommentVNode)("",!0)]),(0,r.createElementVNode)("form",U,[Y,D,q,(0,r.createElementVNode)("button",{id:"submit",class:"h-fit bg-blue-600 hover:bg-blue-500 text-white rounded py-2 px-4",onClick:n[4]||(n[4]=(0,r.withModifiers)((function(e){return function(){return X.apply(this,arguments)}()}),["prevent"]))},G),K]),z,e.error?((0,r.openBlock)(),(0,r.createElementBlock)("div",H,(0,r.toDisplayString)(e.error),1)):(0,r.createCommentVNode)("",!0)])])])],64)}}};var Z=n(85072),R=n.n(Z),$=n(1284),Q={insert:"head",singleton:!1};R()($.A,Q);$.A.locals;const X=(0,n(66262).A)(W,[["__scopeId","data-v-1192cd5a"]])}}]);
//# sourceMappingURL=421.js.map